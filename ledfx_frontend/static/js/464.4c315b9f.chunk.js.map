{"version":3,"file":"static/js/464.4c315b9f.chunk.js","mappings":"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","sources":["workers/pixelGraphWorkerWebGL.ts"],"sourcesContent":["/* eslint-disable no-restricted-globals */\r\ninterface Pixel {\r\n  r: number\r\n  g: number\r\n  b: number\r\n}\r\n\r\ninterface InitWebGLMessage {\r\n  canvas: OffscreenCanvas\r\n}\r\n\r\ninterface UpdateTextureMessage {\r\n  pixels: Pixel[]\r\n  rows: number\r\n  cols: number\r\n}\r\n\r\ntype WorkerMessageGL = InitWebGLMessage | UpdateTextureMessage\r\n\r\nlet canvasGL: OffscreenCanvas\r\nlet gl: WebGLRenderingContext | null\r\nlet texture: WebGLTexture | null\r\n\r\nself.onmessage = (event: MessageEvent<WorkerMessageGL>) => {\r\n  self.postMessage('worker-ready')\r\n  if ('canvas' in event.data) {\r\n    canvasGL = event.data.canvas\r\n    /* expect ts(2769) error */\r\n    gl =\r\n      (canvasGL.getContext('webgl' as OffscreenRenderingContextId) as WebGLRenderingContext) ||\r\n      (canvasGL.getContext(\r\n        'experimental-webgl' as OffscreenRenderingContextId\r\n      ) as WebGLRenderingContext)\r\n    if (!gl) {\r\n      console.error('WebGL not supported')\r\n      return\r\n    }\r\n\r\n    // Initialize WebGL\r\n    initWebGL()\r\n  } else if ('pixels' in event.data) {\r\n    const { pixels, rows, cols } = event.data\r\n    canvasGL.width = cols\r\n    canvasGL.height = rows\r\n    gl?.viewport(0, 0, cols, rows)\r\n\r\n    // Update texture with new pixel data\r\n    updateTexture(pixels, rows, cols)\r\n  }\r\n}\r\n\r\nconst initWebGL = () => {\r\n  const vertexShaderSource = `\r\n    attribute vec2 a_position;\r\n    attribute vec2 a_texCoord;\r\n    varying vec2 v_texCoord;\r\n    void main() {\r\n      gl_Position = vec4(a_position, 0.0, 1.0);\r\n      v_texCoord = a_texCoord;\r\n    }\r\n  `\r\n\r\n  const fragmentShaderSource = `\r\n    precision mediump float;\r\n    varying vec2 v_texCoord;\r\n    uniform sampler2D u_texture;\r\n    void main() {\r\n      gl_FragColor = texture2D(u_texture, v_texCoord);\r\n    }\r\n  `\r\n\r\n  const vertexShader = createShader(gl!.VERTEX_SHADER, vertexShaderSource)\r\n  const fragmentShader = createShader(gl!.FRAGMENT_SHADER, fragmentShaderSource)\r\n  const program = createProgram(vertexShader, fragmentShader)\r\n\r\n  gl!.useProgram(program)\r\n\r\n  // Look up where the vertex data needs to go.\r\n  if (!program) {\r\n    console.error('Failed to create WebGL program')\r\n    return\r\n  }\r\n  const positionLocation = gl!.getAttribLocation(program, 'a_position')\r\n  const texCoordLocation = gl!.getAttribLocation(program, 'a_texCoord')\r\n\r\n  // Create a buffer and put a single clipspace rectangle in it (2 triangles)\r\n  const positionBuffer = gl!.createBuffer()\r\n  gl!.bindBuffer(gl!.ARRAY_BUFFER, positionBuffer)\r\n  gl!.bufferData(\r\n    gl!.ARRAY_BUFFER,\r\n    new Float32Array([-1.0, -1.0, 1.0, -1.0, -1.0, 1.0, -1.0, 1.0, 1.0, -1.0, 1.0, 1.0]),\r\n    gl!.STATIC_DRAW\r\n  )\r\n\r\n  // Create a buffer for texture coordinates\r\n  const texCoordBuffer = gl!.createBuffer()\r\n  gl!.bindBuffer(gl!.ARRAY_BUFFER, texCoordBuffer)\r\n  gl!.bufferData(\r\n    gl!.ARRAY_BUFFER,\r\n    new Float32Array([0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0]),\r\n    gl!.STATIC_DRAW\r\n  )\r\n\r\n  // Create a texture\r\n  texture = gl!.createTexture()\r\n  gl!.bindTexture(gl!.TEXTURE_2D, texture)\r\n  gl!.texParameteri(gl!.TEXTURE_2D, gl!.TEXTURE_WRAP_S, gl!.CLAMP_TO_EDGE)\r\n  gl!.texParameteri(gl!.TEXTURE_2D, gl!.TEXTURE_WRAP_T, gl!.CLAMP_TO_EDGE)\r\n  gl!.texParameteri(gl!.TEXTURE_2D, gl!.TEXTURE_MIN_FILTER, gl!.NEAREST)\r\n  gl!.texParameteri(gl!.TEXTURE_2D, gl!.TEXTURE_MAG_FILTER, gl!.NEAREST)\r\n\r\n  // Tell WebGL how to pull out the positions from the position buffer\r\n  gl!.bindBuffer(gl!.ARRAY_BUFFER, positionBuffer)\r\n  gl!.enableVertexAttribArray(positionLocation)\r\n  gl!.vertexAttribPointer(positionLocation, 2, gl!.FLOAT, false, 0, 0)\r\n\r\n  // Tell WebGL how to pull out the texture coordinates from the texCoord buffer\r\n  gl!.bindBuffer(gl!.ARRAY_BUFFER, texCoordBuffer)\r\n  gl!.enableVertexAttribArray(texCoordLocation)\r\n  gl!.vertexAttribPointer(texCoordLocation, 2, gl!.FLOAT, false, 0, 0)\r\n}\r\n\r\nconst createShader = (type: number, source: string): WebGLShader | null => {\r\n  const shader = gl!.createShader(type)\r\n  if (!shader) {\r\n    console.error('Error creating shader')\r\n    return null\r\n  }\r\n  gl!.shaderSource(shader, source)\r\n  gl!.compileShader(shader)\r\n  if (!gl!.getShaderParameter(shader, gl!.COMPILE_STATUS)) {\r\n    console.error('Error compiling shader:', gl!.getShaderInfoLog(shader))\r\n    gl!.deleteShader(shader)\r\n    return null\r\n  }\r\n  return shader\r\n}\r\n\r\nconst createProgram = (\r\n  vertexShader: WebGLShader | null,\r\n  fragmentShader: WebGLShader | null\r\n): WebGLProgram | null => {\r\n  const program = gl!.createProgram()\r\n  gl!.attachShader(program, vertexShader!)\r\n  gl!.attachShader(program, fragmentShader!)\r\n  gl!.linkProgram(program)\r\n  if (!gl!.getProgramParameter(program, gl!.LINK_STATUS)) {\r\n    console.error('Error linking program:', gl!.getProgramInfoLog(program))\r\n    gl!.deleteProgram(program)\r\n    return null\r\n  }\r\n  return program\r\n}\r\n\r\nconst updateTexture = (pixels: Pixel[], rows: number, cols: number) => {\r\n  gl!.bindTexture(gl!.TEXTURE_2D, texture)\r\n  gl!.texImage2D(\r\n    gl!.TEXTURE_2D,\r\n    0,\r\n    gl!.RGBA,\r\n    cols,\r\n    rows,\r\n    0,\r\n    gl!.RGBA,\r\n    gl!.UNSIGNED_BYTE,\r\n    new Uint8Array(pixels.flatMap((p) => [p.r, p.g, p.b, 255]))\r\n  )\r\n\r\n  // Draw the rectangle\r\n  gl!.clear(gl!.COLOR_BUFFER_BIT)\r\n  gl!.drawArrays(gl!.TRIANGLES, 0, 6)\r\n}\r\n"],"names":["canvasGL","gl","texture","self","onmessage","event","postMessage","data","canvas","getContext","console","error","initWebGL","_gl","pixels","rows","cols","width","height","viewport","updateTexture","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","program","createProgram","useProgram","positionLocation","getAttribLocation","texCoordLocation","positionBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","texCoordBuffer","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","enableVertexAttribArray","vertexAttribPointer","FLOAT","type","source","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteProgram","texImage2D","RGBA","UNSIGNED_BYTE","Uint8Array","flatMap","p","r","g","b","clear","COLOR_BUFFER_BIT","drawArrays","TRIANGLES"],"sourceRoot":""}